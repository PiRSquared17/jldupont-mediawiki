{{extension
|name   = HNP
|image  =
|type   = user rights
|hook1  = userCan
|status = stable
|mediawiki = 1.11
|version = 1.0.0
|update = 
|download = 
|changelog = See [http://mediawiki.googlecode.com/svn/trunk/extensions/HNP/ SVN]
|description = Provides an hierarchical namespace permissions system (aka "prefixes") to Mediawiki without changes to the base installation nor creation of new database tables.
|author = [[user:jldupont|Jean-Lou Dupont]]
}}
== Features ==
* Permission management through simple edition of a page
* Sysop has always all rights regardless of state of registry page
** Enables easier 'human error' management
** <code>MediaWiki:Registry/HNP</code>
* Prefix based namespace access with wildcard
** E.g. 'sysop group has access to all namespaces'
* Namespace dependant & Namespace Independant rights management
* No additional database tables nor changes to schema
* No mandatory patches
** Namespace dependant rights management: no patches necessary
** Namespace independant rights management: if needed, requires a patch:
*** 'includes/User.php'
* Post-installation information always available through [[Special:Version]] page.

== Usage ==
Please see example configuration page [[{{FULLPAGENAME}}/Example|Example]].

== Notes ==
* Please read about '''''[[security issues with authorization extensions]]'''''
* Users interested in this extension might also appreciate [[Extension:BizzWiki]].

== Installation ==
=== PEAR ===
* Install PEAR channel 'http://mediawiki.googlecode.com/svn'
** <code>pear channel-discover http://mediawiki.googlecode.com/svn</code>
* Install extension through PEAR:
** <code>pear install mediawiki/hnp</code>
* Modify <code>LocalSettings.php</code>
=== SVN ===
* Install [[Extension:StubManager]]
* Download archive: [http://mediawiki.googlecode.com/svn/tags/HNP/ SVN]
* Place extension files in MW /extensions directory
* Modify <code>LocalSettings.php</code>
=== LocalSettings.php ===
Modifications to <code>LocalSettings.php</code> is only necessary if not using [[Extension:ExtensionManager]]
* Modification if extension is located in MW installation directory:
<source lang=php>
require 'extensions/HNP/HNP.php';
</source>
* Modification if extension is installed through PEAR:
<source lang=php>
require 'MediaWiki/HNP/HNP.php';
</source>

=== Extension Manager ===
If using [[Extension:ExtensionManager]], then skip the modification to <code>LocalSettings.php</code>.

== User.php patch ==
=== Original file ===
<source lang=php>
	function isAllowed($action='') {
		if ( $action === '' )
			// In the spirit of DWIM
			return true;

		return in_array( $action, $this->getRights() );
	}
</source>
=== Patched file ===
<source lang=php>
	function isAllowed($action='', $ns = null /* addition */, $title = null /* addition */ ) 
	{
		if ( $action === '' )
			// In the spirit of DWIM
			return true;

		//  PATCH begin{{
		$result = null;
		wfRunHooks('UserIsAllowed', array( &$this, $ns, $title, &$action, &$result ) );
		if ( $result !== null )
			return $result;
		// PATCH end }}

		return in_array( $action, $this->getRights() );
	}
</source>

[[Category:Namespace extensions]]
[[Category:Edit extensions]]
[[Category:View page extensions]]
